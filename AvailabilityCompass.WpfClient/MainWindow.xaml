<Window
    x:Class="AvailabilityCompass.WpfClient.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:AvailabilityCompass.WpfClient"
    Title="MainWindow"
    Width="1220"
    Height="780"
    ResizeMode="CanResizeWithGrip"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
    d:DesignHeight="1920"
    d:DesignWidth="1080"
    mc:Ignorable="d">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  - Left navigation rail.  -->
        <materialDesign:Card Grid.Row="1" Grid.RowSpan="2" Grid.Column="0">
            <TabControl
                x:Name="MenuTabControl"
                VerticalContentAlignment="Top"
                materialDesign:ColorZoneAssist.Mode="PrimaryDark"
                ItemsSource="{Binding MainNavigationTabs}"
                SnapsToDevicePixels="True"
                Style="{StaticResource MaterialDesignNavigationRailTabControl}">

                <b:Interaction.Triggers>
                    <b:EventTrigger EventName="SelectionChanged" SourceObject="{Binding ElementName=MenuTabControl}">
                        <b:InvokeCommandAction Command="{Binding TabChangedCommand}"
                                               CommandParameter="{Binding SelectedItem, ElementName=MenuTabControl}" />
                    </b:EventTrigger>
                </b:Interaction.Triggers>

                <TabControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Width="auto" Height="auto">
                            <materialDesign:PackIcon
                                Width="24"
                                Height="24"
                                HorizontalAlignment="Center"
                                Kind="{Binding Icon}" />
                            <TextBlock HorizontalAlignment="Center" Text="{Binding Name}" />
                        </StackPanel>
                    </DataTemplate>
                </TabControl.ItemTemplate>
                <!--  - Remove the content template.  -->
                <TabControl.ContentTemplate>
                    <DataTemplate />
                </TabControl.ContentTemplate>
            </TabControl>
        </materialDesign:Card>

        <!--  Header  -->
        <Grid
            Grid.Row="0"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            Margin="0,0,5,0"
            Panel.ZIndex="1"
            Background="Transparent"
            MouseEnter="ControlBar_MouseEnter"
            MouseLeftButtonDown="ControlBar_MouseLeftButtonDown">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>
            <!--  Logo  -->
            <StackPanel Grid.Column="0" Orientation="Horizontal">

                <Image
                    Height="30"
                    Margin="15,0,0,0"
                    Source="/Images/logo.png" />
                <TextBlock
                    Margin="10,14,0,0"
                    FontSize="16"
                    Foreground="{DynamicResource TitleBrush}"
                    Text="Availability Compass" />
            </StackPanel>
            <StackPanel
                Grid.Column="1"
                Margin="0,0,5,0"
                Panel.ZIndex="1"
                Background="Transparent"
                FlowDirection="RightToLeft"
                MouseEnter="ControlBar_MouseEnter"
                MouseLeftButtonDown="ControlBar_MouseLeftButtonDown"
                Orientation="Horizontal">
                <Button
                    Click="BtnClose_Click"
                    Content="{materialDesign:PackIcon Close}"
                    Style="{DynamicResource MaterialDesignFlatButton}"
                    ToolTip="Close" />
                <Button
                    x:Name="BtnMaximize"
                    Click="BtnMaximize_Click"
                    Command="{Binding MaximizeButtonPressedCommand}"
                    Content="{Binding MaximizeIcon}"
                    Style="{DynamicResource MaterialDesignFlatButton}"
                    ToolTip="{Binding MaximizeToolTip}" />
                <Button
                    Click="BtnMinimize_Click"
                    Content="{materialDesign:PackIcon WindowMinimize}"
                    Style="{DynamicResource MaterialDesignFlatButton}"
                    ToolTip="Minimize" />
            </StackPanel>
        </Grid>

        <!--  - Main content area.  -->
        <Grid Grid.Row="1" Grid.Column="1">
            <ContentControl
                Margin="15,5,15,15"
                Panel.ZIndex="1"
                Content="{Binding CurrentViewModel}" />
        </Grid>
    </Grid>
</Window>